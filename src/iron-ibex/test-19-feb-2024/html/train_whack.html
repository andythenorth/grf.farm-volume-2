


<?xml version="1.0" encoding="iso-8859-1"?>

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
    <title >Iron Ibex: Train Whack!</title>
    <meta http-equiv="Content-Type" content="text/html" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link type="text/css" href="static/css/bootstrap.min.css" rel="stylesheet">
    <link type="text/css" href="static/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link type="text/css" href="static/css/style.css" rel="stylesheet">

    <script type="text/javascript" src="static/js/jquery-3.5.0.min.js"></script>

    <script type="text/javascript" src="static/js/jquery.metadata.js"></script>
    <script type="text/javascript" src="static/js/jquery.tablesorter.min.js"></script>
    <script type="text/javascript" src="static/js/jquery.tablesorter.widgets.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function(){
            $('.tablesorter').tablesorter({
                textExtraction: function(node){
                            var cell_value = $(node).text();
                            var sort_value = $(node).data('value');
                    return (sort_value != undefined) ? sort_value : cell_value;
                 },
            })
        })
    </script>
</head>

<body>
    <div class="navbar navbar-inverse navbar-static-top" style="border-bottom:1px solid #000;">
        <div class="navbar-inner">
            <div class="container">
                <ul class="nav pull-left">
                    <li class="">
                        <a href="get_started.html">Get started</a>
                    </li>
                    <li class="">
                        <a href="trains.html">Trains</a>
                    </li>
                    <li class="">
                        <a href="tech_tree_table_red.html">Tech tree</a>
                    </li>
                    <li class="active">
                        <a href="train_whack.html">Train Whack!</a>
                    </li>
                </ul>
                <ul class="nav pull-right">
                    
                    <li class="">
                        <a href="code_reference.html">Code reference</a>
                    </li>
                    <li class="">
                        <a href="changelog.html">Changelog</a>
                    </li>
                    <li>
                        <a href="https://www.tt-forums.net/viewtopic.php?f=67&amp;t=71219"><i class="icon-comment icon-white"></i> Discuss at TT-Forums.net</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    
    <div>

    <div class="hero-unit subhead" style="margin-bottom:0;">
        <div class="text-center">
            <h1>Iron Ibex: Train Whack</h1>
            <h2>10 randomised train consists</h2>
            <p class="lead">
                You scored <span id="global_high_score_container">0</span>!
                &nbsp;&nbsp;&nbsp;
                Snowplough bonus: <span id="global_snoughplough_count_container">None</span>
            </p>
            
            <script language="JavaScript">
                var global_high_score = 0;
                var global_snoughplough_count = 0;

                function random_consist(){
                    result = new Array;
                    // json parsing is inside the function to avoid the function trying the var before the json parse is complete
                    // inefficient as it will parse json n times, not 1, but easier than figuring out doing it onload
                    var all_consists_grouped=JSON.parse('{"sorted_by_vehicle_type": {"engines": [["ae_3_5", "25", 9040], ["sbb_fb_4_4", "25", 13870], ["saas_be_4_4", "25", 14200], ["obb_1040", "25", 14190], ["sbb_eem_923", "25", 13950], ["ae_3_6_1", "33", 9160], ["obb_1570", "33", 13890], ["obb_1170_2", "25", 13880], ["re_4_4_i", "33", 8990], ["obb_1163", "33", 13130], ["vectron_dual_mode", "33", 13120], ["hungarian_2d2_400", "33", 15410], ["ae_4_7", "33", 8900], ["obb_1041", "33", 13360], ["obb_1141", "33", 13730], ["re_450", "33", 9830], ["obb_1014", "33", 8940], ["fs_e330", "33", 16210], ["fs_e428", "33", 15160], ["fs_e444", "33", 11230], ["fs_e464", "33", 11930], ["fs_e464_upgrade", "33", 13090], ["drg_e_16", "33", 13910], ["obb_1010", "33", 10790], ["obb_1042", "33", 11240], ["obb_1142", "33", 11920], ["fs_e412", "33", 13110], ["fs_e636", "33", 140], ["fs_e646", "33", 160], ["fs_e656", "33", 170], ["fs_e656_upgraded", "33", 180], ["bls_ae_6_8", "33", 13930], ["bls_ae_4_4", "33", 8980], ["bls_re_4_4", "33", 14880], ["sob_re_446", "33", 9500], ["plm_2cc2_3400", "65", 150], ["cc_7100", "33", 16200], ["bb_7200", "33", 14240], ["bb_22200", "33", 9420], ["bb_22200_upgraded", "33", 15400], ["obb_1044", "33", 10920], ["re_460", "33", 9520], ["re_465", "33", 10080], ["cc_6500", "33", 14230], ["bb_26000", "33", 9930], ["bb_26000_upgraded", "33", 8960], ["high_power_railcar_2", "33", 9310], ["high_power_railcar_3", "33", 9330], ["high_power_railcar_4", "33", 9340], ["high_power_railcar_5", "33", 9400], ["de_6_6", "25", 9110], ["trient", "33", 9030], ["krokodil_ce_6_8", "33", 14850], ["krokodil_be_6_8", "33", 9250], ["sbb_ee_6_6_ii", "33", 14860], ["mthb_re_486", "33", 8970], ["po_2d2_5500", "33", 17290], ["bb_25200", "33", 14830], ["bb_27000", "33", 17270], ["sbb_ae_4_6", "33", 8910], ["sbb_re_4_4_ii", "33", 8920], ["re_430", "33", 8930], ["re_430_lion", "33", 13100], ["fs_e633", "33", 17260], ["fs_e652", "33", 9270], ["traxx_e_494", "33", 14870], ["bls_ae_8_8", "49", 130], ["bls_re_475", "33", 8950], ["bb_8100_duo", "49", 190], ["bb_8500_duo", "49", 200], ["re_6_6", "41", 40], ["re_6_6_ii", "41", 50], ["emu_ibex_2", "33", 8850], ["emu_ibex_3", "33", 8860], ["emu_ibex_4", "33", 8870], ["emu_ibex_5", "33", 8880], ["emu_ibex_6", "33", 8890], ["rapide_cab", "65", 8440], ["rapide_middle_mail", "65", 6400], ["rapide_middle_passenger", "65", 440]], "wagons": [["express_intermodal_car_ibex_gen_5B", "25", 12960], ["express_intermodal_car_ibex_gen_5C", "33", 12970], ["intermodal_car_ng_ibex_gen_3A", "17", 13000], ["intermodal_car_ng_ibex_gen_3B", "25", 9630], ["intermodal_car_ibex_gen_4A", "17", 12920], ["intermodal_car_ibex_gen_4B", "25", 12930], ["intermodal_car_ibex_gen_4C", "33", 12750], ["intermodal_car_ibex_gen_5A", "17", 12760], ["intermodal_car_ibex_gen_5B", "25", 12770], ["intermodal_car_ibex_gen_5C", "33", 12780], ["sliding_wall_car_ng_ibex_gen_3A", "17", 11540], ["sliding_wall_car_ng_ibex_gen_3B", "25", 12340], ["sliding_wall_car_ibex_gen_4B", "25", 10610], ["sliding_wall_car_ibex_gen_4C", "33", 10830], ["sliding_wall_car_ibex_gen_5B", "25", 9450], ["sliding_wall_car_ibex_gen_5C", "33", 9480], ["sliding_wall_car_ibex_gen_5D", "41", 5190], ["vehicle_parts_box_car_ng_ibex_gen_3A", "17", 11960], ["vehicle_parts_box_car_ng_ibex_gen_3B", "25", 13340], ["vehicle_parts_box_car_ibex_gen_4B", "25", 18300], ["vehicle_parts_box_car_ibex_gen_4C", "33", 13670], ["vehicle_parts_box_car_ibex_gen_5B", "25", 18320], ["vehicle_parts_box_car_ibex_gen_5C", "33", 13690], ["vehicle_parts_box_car_ibex_gen_5D", "41", 6130], ["goods_box_car_ibex_gen_3A", "17", 16480], ["goods_box_car_ibex_gen_3B", "25", 16490], ["goods_box_car_ibex_gen_4A", "17", 16500], ["goods_box_car_ibex_gen_4B", "25", 16440], ["goods_box_car_ibex_gen_4C", "33", 16450], ["goods_box_car_ibex_gen_5B", "25", 16460], ["goods_box_car_ibex_gen_5C", "33", 16470], ["flat_car_ng_ibex_gen_1A", "17", 10210], ["flat_car_ng_ibex_gen_3A", "17", 10170], ["flat_car_ng_ibex_gen_3B", "25", 14180], ["flat_car_ibex_gen_1A", "17", 10180], ["flat_car_ibex_gen_2B", "25", 10190], ["flat_car_ibex_gen_3A", "17", 10390], ["flat_car_ibex_gen_3B", "25", 10200], ["flat_car_ibex_gen_3C", "33", 11590], ["flat_car_ibex_gen_4A", "17", 10600], ["flat_car_ibex_gen_4B", "25", 11580], ["flat_car_ibex_gen_4C", "33", 11570], ["flat_car_ibex_gen_5B", "25", 11560], ["flat_car_ibex_gen_5C", "33", 11550], ["sliding_roof_car_ibex_gen_5B", "25", 14270], ["sliding_roof_car_ibex_gen_5C", "33", 14280], ["tarpaulin_car_ibex_gen_5B", "25", 9380], ["tarpaulin_car_ibex_gen_5C", "33", 16050], ["ore_dump_car_ibex_gen_3A", "17", 15530], ["ore_dump_car_ibex_gen_3B", "25", 15540], ["ore_dump_car_ibex_gen_4A", "17", 15550], ["ore_dump_car_ibex_gen_4B", "25", 15560], ["ore_dump_car_ibex_gen_5B", "25", 15570], ["ore_dump_car_ibex_gen_5C", "33", 15580], ["tank_car_ng_ibex_gen_1A", "17", 17740], ["tank_car_ng_ibex_gen_3A", "17", 17760], ["tank_car_ng_ibex_gen_3B", "25", 17780], ["tank_car_ibex_gen_1A", "17", 17700], ["tank_car_ibex_gen_2B", "25", 16360], ["tank_car_ibex_gen_3A", "17", 17300], ["tank_car_ibex_gen_3B", "25", 14890], ["tank_car_ibex_gen_3C", "33", 15710], ["tank_car_ibex_gen_4A", "17", 17720], ["tank_car_ibex_gen_4B", "25", 13620], ["tank_car_ibex_gen_4C", "33", 17680], ["tank_car_ibex_gen_5A", "17", 15450], ["tank_car_ibex_gen_5B", "25", 11460], ["tank_car_ibex_gen_5C", "33", 10670], ["product_tank_car_ibex_gen_2A", "17", 8860], ["product_tank_car_ibex_gen_3A", "17", 12400], ["product_tank_car_ibex_gen_3B", "25", 10930], ["product_tank_car_ibex_gen_3C", "33", 17960], ["product_tank_car_ibex_gen_4A", "17", 12420], ["product_tank_car_ibex_gen_4B", "25", 17370], ["product_tank_car_ibex_gen_4C", "33", 12440], ["product_tank_car_ibex_gen_5A", "17", 16950], ["product_tank_car_ibex_gen_5B", "25", 17060], ["product_tank_car_ibex_gen_5C", "33", 12470], ["sulphur_tank_car_ng_ibex_gen_2A", "17", 12810], ["sulphur_tank_car_ng_ibex_gen_3A", "17", 12830], ["sulphur_tank_car_ng_ibex_gen_3B", "25", 17570], ["sulphur_tank_car_ibex_gen_2A", "17", 16080], ["sulphur_tank_car_ibex_gen_3A", "17", 9660], ["sulphur_tank_car_ibex_gen_3B", "25", 9680], ["sulphur_tank_car_ibex_gen_4A", "17", 19270], ["sulphur_tank_car_ibex_gen_4B", "25", 19290], ["sulphur_tank_car_ibex_gen_4C", "33", 19310], ["sulphur_tank_car_ibex_gen_5A", "17", 19330], ["sulphur_tank_car_ibex_gen_5B", "25", 19350], ["sulphur_tank_car_ibex_gen_5C", "33", 19370], ["acid_tank_car_ng_ibex_gen_2A", "17", 10090], ["acid_tank_car_ng_ibex_gen_3A", "17", 11820], ["acid_tank_car_ng_ibex_gen_3B", "25", 17860], ["acid_tank_car_ibex_gen_2A", "17", 15170], ["acid_tank_car_ibex_gen_3A", "17", 16250], ["acid_tank_car_ibex_gen_3B", "25", 15190], ["acid_tank_car_ibex_gen_4A", "17", 15210], ["acid_tank_car_ibex_gen_4B", "25", 13520], ["acid_tank_car_ibex_gen_4C", "33", 15340], ["acid_tank_car_ibex_gen_5A", "17", 15590], ["acid_tank_car_ibex_gen_5B", "25", 15280], ["acid_tank_car_ibex_gen_5C", "33", 15370], ["pressure_tank_car_ng_ibex_gen_2A", "17", 15050], ["pressure_tank_car_ng_ibex_gen_3A", "17", 15060], ["pressure_tank_car_ng_ibex_gen_3B", "25", 15070], ["pressure_tank_car_ibex_gen_2A", "17", 9120], ["pressure_tank_car_ibex_gen_3A", "17", 9220], ["pressure_tank_car_ibex_gen_3B", "25", 9290], ["pressure_tank_car_ibex_gen_4A", "17", 15230], ["pressure_tank_car_ibex_gen_4B", "25", 15240], ["pressure_tank_car_ibex_gen_4C", "33", 15250], ["pressure_tank_car_ibex_gen_5A", "17", 15320], ["pressure_tank_car_ibex_gen_5B", "25", 15260], ["pressure_tank_car_ibex_gen_5C", "33", 15270], ["cryo_tank_car_ibex_gen_4A", "17", 9060], ["cryo_tank_car_ibex_gen_4B", "25", 9090], ["cryo_tank_car_ibex_gen_4C", "33", 9100], ["cryo_tank_car_ibex_gen_5A", "17", 15310], ["cryo_tank_car_ibex_gen_5B", "25", 9130], ["cryo_tank_car_ibex_gen_5C", "33", 9190], ["silo_car_ibex_gen_4A", "17", 12720], ["silo_car_ibex_gen_4B", "25", 17390], ["silo_car_ibex_gen_4C", "33", 17430], ["silo_car_ibex_gen_5A", "17", 12660], ["silo_car_ibex_gen_5B", "25", 17410], ["silo_car_ibex_gen_5C", "33", 12680], ["cement_silo_car_ibex_gen_4A", "17", 10270], ["cement_silo_car_ibex_gen_4B", "25", 10280], ["cement_silo_car_ibex_gen_4C", "33", 10300], ["cement_silo_car_ibex_gen_5A", "17", 10310], ["cement_silo_car_ibex_gen_5B", "25", 10380], ["cement_silo_car_ibex_gen_5C", "33", 10980], ["reefer_car_ibex_gen_2A", "17", 9770], ["reefer_car_ibex_gen_3A", "17", 9760], ["reefer_car_ibex_gen_3B", "25", 16430], ["reefer_car_ibex_gen_4A", "17", 11600], ["reefer_car_ibex_gen_4B", "25", 11630], ["reefer_car_ibex_gen_4C", "33", 12620], ["reefer_car_ibex_gen_5B", "25", 11610], ["reefer_car_ibex_gen_5C", "33", 11620], ["log_car_ng_ibex_gen_1U", "17", 16220], ["log_car_ng_ibex_gen_3U", "17", 16230], ["log_car_ibex_gen_2A", "17", 11780], ["log_car_ibex_gen_3A", "17", 11770], ["log_car_ibex_gen_3B", "25", 11790], ["log_car_ibex_gen_4A", "17", 10750], ["log_car_ibex_gen_4B", "25", 11800], ["log_car_ibex_gen_4C", "33", 10970], ["log_car_ibex_gen_5B", "25", 11810], ["log_car_ibex_gen_5C", "33", 9970], ["kaolin_hopper_car_ibex_gen_5B", "25", 16150], ["kaolin_hopper_car_ibex_gen_5C", "33", 16160], ["carbon_black_hopper_car_ibex_gen_3A", "17", 13450], ["carbon_black_hopper_car_ibex_gen_4A", "17", 13460], ["carbon_black_hopper_car_ibex_gen_4B", "25", 13470], ["carbon_black_hopper_car_ibex_gen_5B", "25", 13490], ["carbon_black_hopper_car_ibex_gen_5C", "33", 13500], ["torpedo_car_ibex_gen_2U", "49", 4140], ["torpedo_car_ibex_gen_3U", "49", 4060], ["torpedo_car_ibex_gen_4U", "49", 4170], ["torpedo_car_ibex_gen_5U", "49", 4090], ["ingot_car_ng_ibex_gen_1U", "17", 5150], ["ingot_car_ibex_gen_1U", "17", 80], ["ingot_car_ibex_gen_4U", "17", 60], ["slag_ladle_car_ng_ibex_gen_1U", "17", 13480], ["slag_ladle_car_ibex_gen_1U", "17", 13070], ["slag_ladle_car_ibex_gen_4U", "17", 13080], ["heavy_duty_dump_car_ng_ibex_gen_1U", "17", 10480], ["heavy_duty_dump_car_ibex_gen_1A", "17", 13720], ["heavy_duty_dump_car_ibex_gen_2B", "25", 16630], ["heavy_duty_dump_car_ibex_gen_4A", "17", 16530], ["heavy_duty_dump_car_ibex_gen_4B", "25", 16190], ["heavy_duty_flat_car_ng_ibex_gen_1U", "17", 13580], ["heavy_duty_flat_car_ibex_gen_1A", "17", 10020], ["heavy_duty_flat_car_ibex_gen_2B", "25", 10240], ["heavy_duty_flat_car_ibex_gen_4A", "17", 10160], ["heavy_duty_flat_car_ibex_gen_4B", "25", 10220]]}, "sorted_by_base_track_type_and_vehicle_type": {"RAIL": {"engines": [["ae_3_5", "25", 9040], ["sbb_fb_4_4", "25", 13870], ["saas_be_4_4", "25", 14200], ["obb_1040", "25", 14190], ["sbb_eem_923", "25", 13950], ["ae_3_6_1", "33", 9160], ["obb_1570", "33", 13890], ["obb_1170_2", "25", 13880], ["re_4_4_i", "33", 8990], ["obb_1163", "33", 13130], ["vectron_dual_mode", "33", 13120], ["hungarian_2d2_400", "33", 15410], ["ae_4_7", "33", 8900], ["obb_1041", "33", 13360], ["obb_1141", "33", 13730], ["re_450", "33", 9830], ["obb_1014", "33", 8940], ["fs_e330", "33", 16210], ["fs_e428", "33", 15160], ["fs_e444", "33", 11230], ["fs_e464", "33", 11930], ["fs_e464_upgrade", "33", 13090], ["drg_e_16", "33", 13910], ["obb_1010", "33", 10790], ["obb_1042", "33", 11240], ["obb_1142", "33", 11920], ["fs_e412", "33", 13110], ["fs_e636", "33", 140], ["fs_e646", "33", 160], ["fs_e656", "33", 170], ["fs_e656_upgraded", "33", 180], ["bls_ae_6_8", "33", 13930], ["bls_ae_4_4", "33", 8980], ["bls_re_4_4", "33", 14880], ["sob_re_446", "33", 9500], ["plm_2cc2_3400", "65", 150], ["cc_7100", "33", 16200], ["bb_7200", "33", 14240], ["bb_22200", "33", 9420], ["bb_22200_upgraded", "33", 15400], ["obb_1044", "33", 10920], ["re_460", "33", 9520], ["re_465", "33", 10080], ["cc_6500", "33", 14230], ["bb_26000", "33", 9930], ["bb_26000_upgraded", "33", 8960], ["high_power_railcar_2", "33", 9310], ["high_power_railcar_3", "33", 9330], ["high_power_railcar_4", "33", 9340], ["high_power_railcar_5", "33", 9400], ["de_6_6", "25", 9110], ["trient", "33", 9030], ["krokodil_ce_6_8", "33", 14850], ["krokodil_be_6_8", "33", 9250], ["sbb_ee_6_6_ii", "33", 14860], ["mthb_re_486", "33", 8970], ["po_2d2_5500", "33", 17290], ["bb_25200", "33", 14830], ["bb_27000", "33", 17270], ["sbb_ae_4_6", "33", 8910], ["sbb_re_4_4_ii", "33", 8920], ["re_430", "33", 8930], ["re_430_lion", "33", 13100], ["fs_e633", "33", 17260], ["fs_e652", "33", 9270], ["traxx_e_494", "33", 14870], ["bls_ae_8_8", "49", 130], ["bls_re_475", "33", 8950], ["bb_8100_duo", "49", 190], ["bb_8500_duo", "49", 200], ["re_6_6", "41", 40], ["re_6_6_ii", "41", 50], ["emu_ibex_2", "33", 8850], ["emu_ibex_3", "33", 8860], ["emu_ibex_4", "33", 8870], ["emu_ibex_5", "33", 8880], ["emu_ibex_6", "33", 8890], ["rapide_cab", "65", 8440], ["rapide_middle_mail", "65", 6400], ["rapide_middle_passenger", "65", 440]], "wagons": [["express_intermodal_car_ibex_gen_5B", "25", 12960], ["express_intermodal_car_ibex_gen_5C", "33", 12970], ["intermodal_car_ibex_gen_4A", "17", 12920], ["intermodal_car_ibex_gen_4B", "25", 12930], ["intermodal_car_ibex_gen_4C", "33", 12750], ["intermodal_car_ibex_gen_5A", "17", 12760], ["intermodal_car_ibex_gen_5B", "25", 12770], ["intermodal_car_ibex_gen_5C", "33", 12780], ["sliding_wall_car_ibex_gen_4B", "25", 10610], ["sliding_wall_car_ibex_gen_4C", "33", 10830], ["sliding_wall_car_ibex_gen_5B", "25", 9450], ["sliding_wall_car_ibex_gen_5C", "33", 9480], ["sliding_wall_car_ibex_gen_5D", "41", 5190], ["vehicle_parts_box_car_ibex_gen_4B", "25", 18300], ["vehicle_parts_box_car_ibex_gen_4C", "33", 13670], ["vehicle_parts_box_car_ibex_gen_5B", "25", 18320], ["vehicle_parts_box_car_ibex_gen_5C", "33", 13690], ["vehicle_parts_box_car_ibex_gen_5D", "41", 6130], ["goods_box_car_ibex_gen_3A", "17", 16480], ["goods_box_car_ibex_gen_3B", "25", 16490], ["goods_box_car_ibex_gen_4A", "17", 16500], ["goods_box_car_ibex_gen_4B", "25", 16440], ["goods_box_car_ibex_gen_4C", "33", 16450], ["goods_box_car_ibex_gen_5B", "25", 16460], ["goods_box_car_ibex_gen_5C", "33", 16470], ["flat_car_ibex_gen_1A", "17", 10180], ["flat_car_ibex_gen_2B", "25", 10190], ["flat_car_ibex_gen_3A", "17", 10390], ["flat_car_ibex_gen_3B", "25", 10200], ["flat_car_ibex_gen_3C", "33", 11590], ["flat_car_ibex_gen_4A", "17", 10600], ["flat_car_ibex_gen_4B", "25", 11580], ["flat_car_ibex_gen_4C", "33", 11570], ["flat_car_ibex_gen_5B", "25", 11560], ["flat_car_ibex_gen_5C", "33", 11550], ["sliding_roof_car_ibex_gen_5B", "25", 14270], ["sliding_roof_car_ibex_gen_5C", "33", 14280], ["tarpaulin_car_ibex_gen_5B", "25", 9380], ["tarpaulin_car_ibex_gen_5C", "33", 16050], ["ore_dump_car_ibex_gen_3A", "17", 15530], ["ore_dump_car_ibex_gen_3B", "25", 15540], ["ore_dump_car_ibex_gen_4A", "17", 15550], ["ore_dump_car_ibex_gen_4B", "25", 15560], ["ore_dump_car_ibex_gen_5B", "25", 15570], ["ore_dump_car_ibex_gen_5C", "33", 15580], ["tank_car_ibex_gen_1A", "17", 17700], ["tank_car_ibex_gen_2B", "25", 16360], ["tank_car_ibex_gen_3A", "17", 17300], ["tank_car_ibex_gen_3B", "25", 14890], ["tank_car_ibex_gen_3C", "33", 15710], ["tank_car_ibex_gen_4A", "17", 17720], ["tank_car_ibex_gen_4B", "25", 13620], ["tank_car_ibex_gen_4C", "33", 17680], ["tank_car_ibex_gen_5A", "17", 15450], ["tank_car_ibex_gen_5B", "25", 11460], ["tank_car_ibex_gen_5C", "33", 10670], ["product_tank_car_ibex_gen_2A", "17", 8860], ["product_tank_car_ibex_gen_3A", "17", 12400], ["product_tank_car_ibex_gen_3B", "25", 10930], ["product_tank_car_ibex_gen_3C", "33", 17960], ["product_tank_car_ibex_gen_4A", "17", 12420], ["product_tank_car_ibex_gen_4B", "25", 17370], ["product_tank_car_ibex_gen_4C", "33", 12440], ["product_tank_car_ibex_gen_5A", "17", 16950], ["product_tank_car_ibex_gen_5B", "25", 17060], ["product_tank_car_ibex_gen_5C", "33", 12470], ["sulphur_tank_car_ibex_gen_2A", "17", 16080], ["sulphur_tank_car_ibex_gen_3A", "17", 9660], ["sulphur_tank_car_ibex_gen_3B", "25", 9680], ["sulphur_tank_car_ibex_gen_4A", "17", 19270], ["sulphur_tank_car_ibex_gen_4B", "25", 19290], ["sulphur_tank_car_ibex_gen_4C", "33", 19310], ["sulphur_tank_car_ibex_gen_5A", "17", 19330], ["sulphur_tank_car_ibex_gen_5B", "25", 19350], ["sulphur_tank_car_ibex_gen_5C", "33", 19370], ["acid_tank_car_ibex_gen_2A", "17", 15170], ["acid_tank_car_ibex_gen_3A", "17", 16250], ["acid_tank_car_ibex_gen_3B", "25", 15190], ["acid_tank_car_ibex_gen_4A", "17", 15210], ["acid_tank_car_ibex_gen_4B", "25", 13520], ["acid_tank_car_ibex_gen_4C", "33", 15340], ["acid_tank_car_ibex_gen_5A", "17", 15590], ["acid_tank_car_ibex_gen_5B", "25", 15280], ["acid_tank_car_ibex_gen_5C", "33", 15370], ["pressure_tank_car_ibex_gen_2A", "17", 9120], ["pressure_tank_car_ibex_gen_3A", "17", 9220], ["pressure_tank_car_ibex_gen_3B", "25", 9290], ["pressure_tank_car_ibex_gen_4A", "17", 15230], ["pressure_tank_car_ibex_gen_4B", "25", 15240], ["pressure_tank_car_ibex_gen_4C", "33", 15250], ["pressure_tank_car_ibex_gen_5A", "17", 15320], ["pressure_tank_car_ibex_gen_5B", "25", 15260], ["pressure_tank_car_ibex_gen_5C", "33", 15270], ["cryo_tank_car_ibex_gen_4A", "17", 9060], ["cryo_tank_car_ibex_gen_4B", "25", 9090], ["cryo_tank_car_ibex_gen_4C", "33", 9100], ["cryo_tank_car_ibex_gen_5A", "17", 15310], ["cryo_tank_car_ibex_gen_5B", "25", 9130], ["cryo_tank_car_ibex_gen_5C", "33", 9190], ["silo_car_ibex_gen_4A", "17", 12720], ["silo_car_ibex_gen_4B", "25", 17390], ["silo_car_ibex_gen_4C", "33", 17430], ["silo_car_ibex_gen_5A", "17", 12660], ["silo_car_ibex_gen_5B", "25", 17410], ["silo_car_ibex_gen_5C", "33", 12680], ["cement_silo_car_ibex_gen_4A", "17", 10270], ["cement_silo_car_ibex_gen_4B", "25", 10280], ["cement_silo_car_ibex_gen_4C", "33", 10300], ["cement_silo_car_ibex_gen_5A", "17", 10310], ["cement_silo_car_ibex_gen_5B", "25", 10380], ["cement_silo_car_ibex_gen_5C", "33", 10980], ["reefer_car_ibex_gen_2A", "17", 9770], ["reefer_car_ibex_gen_3A", "17", 9760], ["reefer_car_ibex_gen_3B", "25", 16430], ["reefer_car_ibex_gen_4A", "17", 11600], ["reefer_car_ibex_gen_4B", "25", 11630], ["reefer_car_ibex_gen_4C", "33", 12620], ["reefer_car_ibex_gen_5B", "25", 11610], ["reefer_car_ibex_gen_5C", "33", 11620], ["log_car_ibex_gen_2A", "17", 11780], ["log_car_ibex_gen_3A", "17", 11770], ["log_car_ibex_gen_3B", "25", 11790], ["log_car_ibex_gen_4A", "17", 10750], ["log_car_ibex_gen_4B", "25", 11800], ["log_car_ibex_gen_4C", "33", 10970], ["log_car_ibex_gen_5B", "25", 11810], ["log_car_ibex_gen_5C", "33", 9970], ["kaolin_hopper_car_ibex_gen_5B", "25", 16150], ["kaolin_hopper_car_ibex_gen_5C", "33", 16160], ["carbon_black_hopper_car_ibex_gen_3A", "17", 13450], ["carbon_black_hopper_car_ibex_gen_4A", "17", 13460], ["carbon_black_hopper_car_ibex_gen_4B", "25", 13470], ["carbon_black_hopper_car_ibex_gen_5B", "25", 13490], ["carbon_black_hopper_car_ibex_gen_5C", "33", 13500], ["torpedo_car_ibex_gen_2U", "49", 4140], ["torpedo_car_ibex_gen_3U", "49", 4060], ["torpedo_car_ibex_gen_4U", "49", 4170], ["torpedo_car_ibex_gen_5U", "49", 4090], ["ingot_car_ibex_gen_1U", "17", 80], ["ingot_car_ibex_gen_4U", "17", 60], ["slag_ladle_car_ibex_gen_1U", "17", 13070], ["slag_ladle_car_ibex_gen_4U", "17", 13080], ["heavy_duty_dump_car_ibex_gen_1A", "17", 13720], ["heavy_duty_dump_car_ibex_gen_2B", "25", 16630], ["heavy_duty_dump_car_ibex_gen_4A", "17", 16530], ["heavy_duty_dump_car_ibex_gen_4B", "25", 16190], ["heavy_duty_flat_car_ibex_gen_1A", "17", 10020], ["heavy_duty_flat_car_ibex_gen_2B", "25", 10240], ["heavy_duty_flat_car_ibex_gen_4A", "17", 10160], ["heavy_duty_flat_car_ibex_gen_4B", "25", 10220]]}, "NG": {"wagons": [["intermodal_car_ng_ibex_gen_3A", "17", 13000], ["intermodal_car_ng_ibex_gen_3B", "25", 9630], ["sliding_wall_car_ng_ibex_gen_3A", "17", 11540], ["sliding_wall_car_ng_ibex_gen_3B", "25", 12340], ["vehicle_parts_box_car_ng_ibex_gen_3A", "17", 11960], ["vehicle_parts_box_car_ng_ibex_gen_3B", "25", 13340], ["flat_car_ng_ibex_gen_1A", "17", 10210], ["flat_car_ng_ibex_gen_3A", "17", 10170], ["flat_car_ng_ibex_gen_3B", "25", 14180], ["tank_car_ng_ibex_gen_1A", "17", 17740], ["tank_car_ng_ibex_gen_3A", "17", 17760], ["tank_car_ng_ibex_gen_3B", "25", 17780], ["sulphur_tank_car_ng_ibex_gen_2A", "17", 12810], ["sulphur_tank_car_ng_ibex_gen_3A", "17", 12830], ["sulphur_tank_car_ng_ibex_gen_3B", "25", 17570], ["acid_tank_car_ng_ibex_gen_2A", "17", 10090], ["acid_tank_car_ng_ibex_gen_3A", "17", 11820], ["acid_tank_car_ng_ibex_gen_3B", "25", 17860], ["pressure_tank_car_ng_ibex_gen_2A", "17", 15050], ["pressure_tank_car_ng_ibex_gen_3A", "17", 15060], ["pressure_tank_car_ng_ibex_gen_3B", "25", 15070], ["log_car_ng_ibex_gen_1U", "17", 16220], ["log_car_ng_ibex_gen_3U", "17", 16230], ["ingot_car_ng_ibex_gen_1U", "17", 5150], ["slag_ladle_car_ng_ibex_gen_1U", "17", 13480], ["heavy_duty_dump_car_ng_ibex_gen_1U", "17", 10480], ["heavy_duty_flat_car_ng_ibex_gen_1U", "17", 13580]]}}}');

                    var engines_weighting = [1, 1, 1, 1, 2, 2, 3];
                    var wagons_weighting = [3, 4, 5, 5, 6, 6, 6, 6, 7, 7, 7, 8, 8, 8, 9, 9, 10, 11, 12];

                    var base_track_type_keys = Object.keys(all_consists_grouped['sorted_by_base_track_type_and_vehicle_type']);

                    // there is an optional query parameter to force consists to use same base track type
                    // when that isn't used, alternate simpler engine / wagon lists are used without walking the track types, as it gets better random results
                    // there's various jank for handling metro and NG due to them being a limited selection of vehicles
                    if (get_query_param('match_base_track_type') == 'true') {
                        var base_track_type_keys_weighted = [];
                        for (base_track_type_key of base_track_type_keys) {
                            // metro jank, we want metro rather less than other types, without having to know all types, so use this crude hack
                            if (base_track_type_key == 'METRO') {
                                base_track_type_keys_weighted.push(base_track_type_key);
                            }
                            else if (base_track_type_key == 'NG') {
                                base_track_type_keys_weighted.push(base_track_type_key);
                                base_track_type_keys_weighted.push(base_track_type_key);
                            }
                            else {
                                base_track_type_keys_weighted.push(base_track_type_key);
                                base_track_type_keys_weighted.push(base_track_type_key);
                                base_track_type_keys_weighted.push(base_track_type_key);
                            }
                        }
                        // note use of weighted keys to prevent too much metro when same base_track_type_name is enforced
                        var base_track_type_key = base_track_type_keys_weighted[Math.floor(Math.random()*base_track_type_keys_weighted.length)];
                        consists = all_consists_grouped['sorted_by_base_track_type_and_vehicle_type'][base_track_type_key];
                        // metro jank, override weightings if metro, as there are no wagons and so more engines than usual are needed
                        if (base_track_type_key == 'METRO') {
                            engines_weighting = [1, 2, 2, 3, 3, 3, 3, 4, 4, 5, 6];
                        }
                    }
                    else {
                        consists = all_consists_grouped['sorted_by_vehicle_type'];
                    }

                    // get the images and write into page
                    result = extend_result(consists['engines'], engines_weighting, result);
                    result = extend_result(consists['wagons'], wagons_weighting, result);
                    document.write(result.toString());

                    // arbitrary high score crap
                    var global_high_score_container = document.getElementById("global_high_score_container");
                    global_high_score_container.innerHTML = global_high_score * Math.pow(2, global_snoughplough_count);
                    var global_snoughplough_count_container = document.getElementById("global_snoughplough_count_container");
                    if (global_snoughplough_count > 0) {
                        global_snoughplough_count_container.innerHTML = global_snoughplough_count + ' = ' + Math.pow(2, global_snoughplough_count) + 'x score multiplier';
                    }

                    return true;
                }

                function extend_result(consists, weighting, result) {
                    // note the guard here against vehicles not existing (e.g. metro wagons)
                    if (consists != undefined) {
                        const num_vehicles_to_draw = weighting[Math.floor(Math.random()*weighting.length)];
                        if (get_query_param('boring_mode') == 'true') {
                            var random_image = get_random_image(consists);
                        }
                        for (i = 0; i < num_vehicles_to_draw; i++) {
                            if (get_query_param('boring_mode') != 'true') {
                                random_image = get_random_image(consists);
                            }
                            result.push(get_image_html(random_image));
                        };
                    }
                    return result;
                }

                function get_random_image(images) {
                    var index = Math.floor(Math.random()*images.length);
                    return images.splice(index, 1)[0]; // splice returns an array, and we need the nested array inside it
                }

                function get_image_html(random_image){
                    // update scores, probably should be a separate function but eh
                    global_high_score += random_image[2];
                    if (random_image[0].indexOf('snowplough') != -1) {
                        global_snoughplough_count = global_snoughplough_count + 1;
                    }
                    // image
                    var sprite_size_factor = get_query_param('sprite_size_factor') ? get_query_param('sprite_size_factor') : 3;
                    return '<a href="trains.html#' + random_image[0] + '" style="display:inline-block; margin-top:' + 5 * sprite_size_factor + 'px; margin-bottom:' + 5 * sprite_size_factor + 'px; margin-right:-' + sprite_size_factor + 'px;"> \
                                <img src="static/img/'+ random_image[0] + '_variant_0_red_white.png" \
                                     style="width:' + sprite_size_factor * random_image[1] + 'px; height:' + sprite_size_factor * 16 + 'px; margin:0;"> \
                           </a>'; // -ve margin right used to overlap buffers etc
                }

                function get_query_param(param_name) {
                       var query = window.location.search.substring(1);
                       var vars = query.split("&");
                       for (var i = 0; i < vars.length; i++) {
                               var pair = vars[i].split("=");
                               if(pair[0] == param_name){return pair[1];}
                       }
                       return(false);
                }

                function reload_with_parameter_changed(param_name, param_value) {
                    var query = window.location.search.substring(1);
                    var vars = query.split("&");
                    var new_query_vars = [param_name + '=' + param_value];
                    for (var i = 0; i < vars.length; i++) {
                        var pair = vars[i].split("=");
                        // undefined checked to prevent extra junk parameter being added, quite janky
                        if(pair[0] != param_name && pair[1] != undefined) {
                            new_query_vars.push(pair[0] + '=' + pair[1]);
                        }
                    }
                    new_url = window.location.protocol + window.location.pathname + '?' + new_query_vars.join('&');
                    window.location.assign(new_url);
                }
            </script>
            <p>
                Play again?
                &nbsp;&nbsp;&nbsp;
                Track type:
                <a style="color:white;" href="javascript:void(0);" onclick="return reload_with_parameter_changed('match_base_track_type', true);">Same within consist</a>
                |
                <a style="color:white;" href="javascript:void(0);" onclick="return reload_with_parameter_changed('match_base_track_type', false);">Random per vehicle</a>
                &nbsp;&nbsp;&nbsp;
                Zoom:
                <a style="color:white;" href="javascript:void(0);" onclick="return reload_with_parameter_changed('sprite_size_factor', 2);">2x</a>
                |
                <a style="color:white;" href="javascript:void(0);" onclick="return reload_with_parameter_changed('sprite_size_factor', 3);">3x</a>
                |
                <a style="color:white;" href="javascript:void(0);" onclick="return reload_with_parameter_changed('sprite_size_factor', 4);">4x</a>
                &nbsp;&nbsp;&nbsp;
                Boring mode:
                <a style="color:white;" href="javascript:void(0);" onclick="return reload_with_parameter_changed('boring_mode', false);">Off</a>
                |
                <a style="color:white;" href="javascript:void(0);" onclick="return reload_with_parameter_changed('boring_mode', true);">On</a>
            </p>
            <div>
                <div style="font-size:0;">
                    <script language="JavaScript">
                        random_consist();
                    </script>
                </div>
                <hr style="border-bottom:0; border-top-color:rgba(0, 0, 0, 0.3); line-height:10px; margin:0;"/>
            </div>
            <div>
                <div style="font-size:0;">
                    <script language="JavaScript">
                        random_consist();
                    </script>
                </div>
                <hr style="border-bottom:0; border-top-color:rgba(0, 0, 0, 0.3); line-height:10px; margin:0;"/>
            </div>
            <div>
                <div style="font-size:0;">
                    <script language="JavaScript">
                        random_consist();
                    </script>
                </div>
                <hr style="border-bottom:0; border-top-color:rgba(0, 0, 0, 0.3); line-height:10px; margin:0;"/>
            </div>
            <div>
                <div style="font-size:0;">
                    <script language="JavaScript">
                        random_consist();
                    </script>
                </div>
                <hr style="border-bottom:0; border-top-color:rgba(0, 0, 0, 0.3); line-height:10px; margin:0;"/>
            </div>
            <div>
                <div style="font-size:0;">
                    <script language="JavaScript">
                        random_consist();
                    </script>
                </div>
                <hr style="border-bottom:0; border-top-color:rgba(0, 0, 0, 0.3); line-height:10px; margin:0;"/>
            </div>
            <div>
                <div style="font-size:0;">
                    <script language="JavaScript">
                        random_consist();
                    </script>
                </div>
                <hr style="border-bottom:0; border-top-color:rgba(0, 0, 0, 0.3); line-height:10px; margin:0;"/>
            </div>
            <div>
                <div style="font-size:0;">
                    <script language="JavaScript">
                        random_consist();
                    </script>
                </div>
                <hr style="border-bottom:0; border-top-color:rgba(0, 0, 0, 0.3); line-height:10px; margin:0;"/>
            </div>
            <div>
                <div style="font-size:0;">
                    <script language="JavaScript">
                        random_consist();
                    </script>
                </div>
                <hr style="border-bottom:0; border-top-color:rgba(0, 0, 0, 0.3); line-height:10px; margin:0;"/>
            </div>
            <div>
                <div style="font-size:0;">
                    <script language="JavaScript">
                        random_consist();
                    </script>
                </div>
                <hr style="border-bottom:0; border-top-color:rgba(0, 0, 0, 0.3); line-height:10px; margin:0;"/>
            </div>
            <div>
                <div style="font-size:0;">
                    <script language="JavaScript">
                        random_consist();
                    </script>
                </div>
                <hr style="border-bottom:0; border-top-color:rgba(0, 0, 0, 0.3); line-height:10px; margin:0;"/>
            </div>
        </div>
    </div>

</div>
    <div style="text-align:center; color:#999; padding:5px; background-color:#eee; border-top:solid 1px #ddd; box-shadow: inset 0px 1px 1px #ddd">
        Iron Ibex, with thanks to all who helped
    </div>
</body>
</html>












